{{ config(
  materialized='table'
  
) }}

SELECT 
    -- Required fields per new schema
    CAST(c1 AS bigint) AS c1,
    CAST(c2 AS bigint) AS c2,
    CAST(c3 AS bigint) AS c3,
    CAST(e1 AS bigint) AS e1,
    CAST(e2 AS bigint) AS e2,
    CAST(s1 AS bigint) AS s1,
    CAST(s2 AS bigint) AS s2,
    CAST(s3 AS bigint) AS s3,
    CAST(s4 AS bigint) AS s4,
    "KEY",
    c1a,
    c2a,
    CAST(cc1 AS bigint) AS cc1,
    CAST(cc2 AS bigint) AS cc2,
    CAST(cc3 AS bigint) AS cc3,
    CAST(cc4 AS bigint) AS cc4,
    CAST(cc5 AS bigint) AS cc5,
    CAST(se1 AS bigint) AS se1,
    CAST(se2 AS bigint) AS se2,
    CAST(se3 AS bigint) AS se3,
    CAST(se4 AS bigint) AS se4,
    CAST(se5 AS bigint) AS se5,
    CAST(cro1 AS bigint) AS cro1,
    CAST(cro2 AS bigint) AS cro2,
    CAST(cro3 AS bigint) AS cro3,
    CAST(cro4 AS bigint) AS cro4,
    CAST(cro5 AS bigint) AS cro5,
    CAST(cro7 AS bigint) AS cro7,
    CAST(cro8 AS bigint) AS cro8,
    CAST(cro9 AS bigint) AS cro9,
    date,
    CAST(cro10 AS bigint) AS cro10,
    CAST(cro11 AS bigint) AS cro11,
    CAST(cro12 AS bigint) AS cro12,
    cro7a,
    cro8a,
    forms,
    caseid,
    CASE WHEN btrim(cro13a) ~ '^[0-9]+$' THEN btrim(cro13a)::bigint ELSE NULL END AS cro13a,
    CASE WHEN btrim(cro13b) ~ '^[0-9]+$' THEN btrim(cro13b)::bigint ELSE NULL END AS cro13b,
    CASE WHEN btrim(cro13c) ~ '^[0-9]+$' THEN btrim(cro13c)::bigint ELSE NULL END AS cro13c,
    endtime,
    meeting,
    program,
    remarks,
    cro13aii,
    deviceid,
    CAST(duration AS bigint) AS duration,
    CAST(expected AS bigint) AS expected,
    username,
    programme,
    starttime,
    formdef_id,
    "instanceID",
    device_info,
    district_kt,
    division_kt,
    CAST(malepresent AS bigint) AS malepresent,
    school_name,
    coach_gender,
    date_coaching,
    CAST(femalepresent AS bigint) AS femalepresent,
    observer_role,
    role_coaching,
    "SubmissionDate",
    coachee_gender,
    devicephonenum,
    review_quality,
    teacher_gender,
    teacher_others,
    CAST(formdef_version AS bigint) AS formdef_version,
    observer_gender,
    observer_others,
    facilitator_role,
    meeting_coaching,
    observation_term,
    remarks_coaching,
    CAST(duration_coaching AS bigint) AS duration_coaching,
    name_of_the_coach,
    remarks_classroom,
    facilitator_gender,
    facilitator_others,
    name_of_the_coachee,
    coach_gender_specify,
    coachee_gender_specify,
    observer_role_coaching,
    facilitator_role_coaching,
    _airbyte_raw_id,
    _airbyte_extracted_at,
    _airbyte_meta
    -- Non-schema fields retained as inline comments (not selected):
    -- n1,
    -- n2,
    -- n3,
    -- n4,
    -- n1_secd,
    -- observer_gender_male,
    -- facilitator_gender_male,
    -- observer_role_na,
    -- observer_role_brp,
    -- observer_role_coaching_nodal,
    -- facilitator_role_mrp,
    -- n_seca,
    -- n_secc,
    -- facilitator_role_external,
    -- observer_role_diet_principal,
    -- observer_role_dc,
    -- observer_role_coaching_stir_dl,
    -- review_status,
    -- "CompletionDate",
    -- observer_role_crp,
    -- observer_role_nodal,
    -- observer_gender_female,
    -- observer_role_coaching_brp,
    -- observer_role_coaching_diet_principal,
    -- facilitator_role_brp
FROM {{ source('source_classroom_surveys_new', 'kt_data') }}