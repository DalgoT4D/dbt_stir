{{ config(
  materialized='table',
  schema=generate_schema_name('prod_intermediate', this)
) }}

with cte as (
  {{ flatten_json(
      model_name = source('source_classroom_surveys_dev', 'uganda'),
      json_column = 'data'
  ) }}
)

SELECT 
    cro13aiii_exit_ticket::bigint,
    cro13aiii_spaced_practice::bigint,
    cro13aiii_formative_assessment_strategies::bigint,
    starttime,
    "SubmissionDate",
    cro13aiii_elaborative_questioning::bigint,
    coachee_gender::varchar,
    location_uganda::varchar,
    c2a::varchar,
    district_busoga::varchar,
    remarks_coaching::varchar,
    district_rwenzori::varchar,
    facilitator_others::varchar,
    teacher_others::varchar,
    cro13aiii_worked_examples::bigint,
    meeting::varchar,
    s1::bigint,
    se1::bigint,
    s2::bigint,
    s3::bigint,
    se3::bigint,
    s4::bigint,
    se2::bigint,
    se5::bigint,
    n5_sece::varchar,
    se4::bigint,
    expected::bigint,
    c1::bigint,
    c2::bigint,
    c3::bigint,
    cro13aiii_breaking_down_learning::bigint,
    caseid::varchar,
    meeting_coaching::varchar,
    "KEY"::varchar,
    cro7a::varchar,
    n_seca::varchar,
    b_secb::varchar,
    n_secc::varchar,
    district_central::varchar,
    cro13aiii_focussed_lesson_objective::bigint,
    cro13aiii_the_four_corners::bigint,
    cro13aiii_giving___receiving_feedback::bigint,
    name_of_the_coach::varchar,
    cro13aiii_covid_19_strategies::bigint,
    n4_sece::varchar,
    review_quality::varchar,
    cro10::bigint,
    cro13aiii_dual_coding::bigint,
    facilitator_role_coaching::varchar,
    review_status::varchar,
    "CompletionDate",
    facilitator_role::varchar,
    district_lango::varchar,
    endtime,
    e1::bigint,
    e2::bigint,
    e3::bigint,
    cro13aiii_growth_mindset::bigint,
    cro8::bigint,
    cro9::bigint,
    cro7::bigint,
    cro4::bigint,
    cro5::bigint,
    cro2::bigint,
    cro3::bigint,
    duration_coaching::bigint,
    cro13aiii_asking_effective_questions::bigint,
    cro1::bigint,
    date,
    n1::varchar,
    n2::varchar,
    n3::varchar,
    n4::varchar,
    cro13aiii_socio_emotional_wellbeing::bigint,
    n1_sece::varchar,
    cro13aiii_physical_learning_environment::bigint,
    observer_others::varchar,
    coach_gender::varchar,
    district_karamoja::varchar,
    n1_secd::varchar,
    cro13aiii_emotional_learning_environment::bigint,
    cro8a::varchar,
    observer_gender::varchar,
    observer_role::varchar,
    cro11::bigint,
    cro12::bigint,
    name_of_the_coachee::varchar,
    district_acholi::varchar,
    remarks_classroom::varchar,
    district_mbale::varchar,
    "instanceID"::varchar,
    devicephonenum::varchar,
    education_level::varchar,
    teacher_gender::varchar,
    n2_sece::varchar,
    district_kigezi::varchar,
    plname::varchar,
    cro13c::bigint,
    cro13b::bigint,
    n3_sece::varchar,
    cc1::bigint,
    duration::bigint,
    district_teso::varchar,
    cc3::bigint,
    district_westnile::varchar,
    cc2::bigint,
    cc5::bigint,
    femalepresent::bigint,
    cc4::bigint,
    "cro13aiii_safe_learning_Environment"::bigint,
    observation_term::varchar,
    date_coaching::varchar,
    forms_uganda::varchar,
    district_midwestern::varchar,
    deviceid::varchar,
    district_ankole::varchar,
    formdef_version::bigint,
    c1a::varchar,
    district_masaka::varchar,
    device_info::varchar,
    cro13a::varchar,
    district_bunyoro::varchar,
    cro13aiii_retrieval_practices::bigint,
    role_coaching::varchar,
    facilitator_gender::varchar,
    remarks::varchar,
    malepresent::bigint,
    username::varchar
FROM cte