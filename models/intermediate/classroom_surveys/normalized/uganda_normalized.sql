{{ config(
  materialized='table',
  schema=generate_schema_name('prod_intermediate', this)
) }}

with cte as (
  {{ flatten_json(
      model_name = source('source_classroom_surveys', 'uganda'),
      json_column = 'data'
  ) }}
)

SELECT 
    null as program,
    cro13aiii_exit_ticket::bigint,
    cro13aiii_spaced_practice::bigint,
    cro13aiii_formative_assessment_strategies::bigint,
    starttime,
    "SubmissionDate",
    cro13aiii_elaborative_questioning::bigint,
    coachee_gender,
    location_uganda,
    c2a,
    district_busoga,
    remarks_coaching,
    district_rwenzori,
    facilitator_others,
    teacher_others,
    cro13aiii_worked_examples::bigint,
    meeting,
    s1::bigint,
    se1::bigint,
    s2::bigint,
    s3::bigint,
    se3::bigint,
    s4::bigint,
    se2::bigint,
    se5::bigint,
    n5_sece,
    se4::bigint,
    expected::bigint,
    c1::bigint,
    c2::bigint,
    c3::bigint,
    cro13aiii_breaking_down_learning::bigint,
    caseid,
    meeting_coaching,
    "KEY",
    cro7a,
    n_seca,
    b_secb,
    n_secc,
    district_central,
    cro13aiii_focussed_lesson_objective::bigint,
    cro13aiii_the_four_corners::bigint,
    cro13aiii_giving___receiving_feedback::bigint,
    name_of_the_coach,
    cro13aiii_covid_19_strategies::bigint,
    n4_sece,
    review_quality,
    cro10::bigint,
    cro13aiii_dual_coding::bigint,
    facilitator_role_coaching,
    review_status,
    "CompletionDate",
    facilitator_role,
    district_lango,
    endtime,
    e1::bigint,
    e2::bigint,
    e3::bigint,
    cro13aiii_growth_mindset::bigint,
    cro8::bigint,
    cro9::bigint,
    cro7::bigint,
    cro4::bigint,
    cro5::bigint,
    cro2::bigint,
    cro3::bigint,
    duration_coaching::bigint,
    cro13aiii_asking_effective_questions::bigint,
    cro1::bigint,
    date,
    n1,
    n2,
    n3,
    n4,
    cro13aiii_socio_emotional_wellbeing::bigint,
    n1_sece,
    cro13aiii_physical_learning_environment::bigint,
    observer_others,
    coach_gender,
    district_karamoja,
    n1_secd,
    cro13aiii_emotional_learning_environment::bigint,
    cro8a,
    observer_gender,
    observer_role,
    cro11::bigint,
    cro12::bigint,
    name_of_the_coachee,
    district_acholi,
    remarks_classroom,
    district_mbale,
    "instanceID",
    devicephonenum,
    education_level,
    teacher_gender,
    n2_sece,
    district_kigezi,
    plname,
    cro13c::bigint,
    cro13b::bigint,
    n3_sece,
    cc1::bigint,
    duration::bigint,
    district_teso,
    cc3::bigint,
    district_westnile,
    cc2::bigint,
    cc5::bigint,
    femalepresent::bigint,
    cc4::bigint,
    "cro13aiii_safe_learning_Environment"::bigint,
    observation_term,
    date_coaching,
    forms_uganda,
    district_midwestern,
    deviceid,
    district_ankole,
    formdef_version::bigint,
    c1a,
    district_masaka,
    device_info,
    cro13a,
    district_bunyoro,
    cro13aiii_retrieval_practices::bigint,
    role_coaching,
    facilitator_gender,
    remarks,
    malepresent::bigint,
    username
FROM cte