{{ config(
  materialized='table'
) }}

SELECT
    CAST(c1 AS bigint) AS c1,
    CAST(c2 AS bigint) AS c2,
    CAST(c3 AS bigint) AS c3,
    CAST(e1 AS bigint) AS e1,
    CAST(e2 AS bigint) AS e2,
    CAST(c1 AS bigint) AS e3,
    CAST(s1 AS bigint) AS s1,
    CAST(s2 AS bigint) AS s2,
    CAST(s3 AS bigint) AS s3,
    CAST(s4 AS bigint) AS s4,
    "KEY",
    c1a,
    c2a,
    CAST(cc1 AS bigint) AS cc1,
    CAST(cc2 AS bigint) AS cc2,
    CAST(cc3 AS bigint) AS cc3,
    CAST(cc4 AS bigint) AS cc4,
    CAST(cc5 AS bigint) AS cc5,
    CAST(se1 AS bigint) AS se1,
    CAST(se2 AS bigint) AS se2,
    CAST(se3 AS bigint) AS se3,
    CAST(se4 AS bigint) AS se4,
    CAST(se5 AS bigint) AS se5,
    CAST(ad_q AS bigint) AS ad_q,
    CAST(cro1 AS bigint) AS cro1,
    CAST(cro2 AS bigint) AS cro2,
    CAST(cro3 AS bigint) AS cro3,
    CAST(cro4 AS bigint) AS cro4,
    CAST(cro5 AS bigint) AS cro5,
    CAST(cro7 AS bigint) AS cro7,
    CAST(cro8 AS bigint) AS cro8,
    CAST(cro9 AS bigint) AS cro9,
    date,
    CAST(cro10 AS bigint) AS cro10,
    CAST(cro11 AS bigint) AS cro11,
    CAST(cro12 AS bigint) AS cro12,
    cro7a,
    cro8a,
    caseid,
    cro13a,
    CASE WHEN btrim(cro13b) ~ '^[0-9]+$' THEN btrim(cro13b)::bigint ELSE NULL END AS cro13b,
    CASE WHEN btrim(cro13c) ~ '^[0-9]+$' THEN btrim(cro13c)::bigint ELSE NULL END AS cro13c,
    NULL::bigint AS cro13ai_behavior_engagement,
    NULL::bigint AS cro13ai_behavior_safety,
    NULL::bigint AS cro13ai_behavior_selfesteem,
    NULL::bigint AS cro13ai_building_a_stronger_community,
    NULL::bigint AS cro13ai_building_connect,
    NULL::bigint AS cro13ai_classroom_routines,
    NULL::bigint AS cro13ai_lesson_planning,
    NULL::bigint AS cro13ai_look_for_understanding___respond,
    NULL::bigint AS cro13ai_mission_buniyad,
    NULL::bigint AS cro13ai_psychological_safety,
    NULL::bigint AS cro13ai_social___emotional_wellbeing,
    NULL::bigint AS cro13ai_teaching___learning_strategies_1,
    NULL::bigint AS cro13ai_teaching___learning_strategies_2,
    NULL::bigint AS cro13aiii_asking_effective_questions,
    NULL::bigint AS cro13aiii_elaborative_questioning,
    NULL::bigint AS cro13aiii_emotional_learning_environment,
    NULL::bigint AS cro13aiii_growth_mindset,
    NULL::bigint AS cro13aiii_physical_learning_environment,
    NULL::bigint AS cro13aiii_retrieval_practices,
    NULL::bigint AS cro13aiii_worked_examples,
    NULL::bigint AS cro13aiv_bridging_covid19_learning_losses,
    NULL::bigint AS cro13aiv_classroom_routines,
    NULL::bigint AS cro13aiv_longterm_learning,
    NULL::bigint AS cro13aiv_na,
    NULL::bigint AS cro13aiv_socio_emotional_wellbeing,
    NULL::bigint AS cro13aiv_structuring_learning_journey,
    NULL::bigint AS cro13av_growth_mindset,
    NULL::bigint AS cro13av_normalising_error,
    NULL::bigint AS ad1,
    NULL::bigint AS ad2,
    NULL::bigint AS ad3,
    NULL::bigint AS ad4,
    NULL::bigint AS ad5,
    NULL::bigint AS ad7,
    NULL::bigint AS ad8,
    NULL::bigint AS ad9,
    NULL::bigint AS sr1,
    NULL::bigint AS sr2,
    NULL::bigint AS sr3,
    NULL::bigint AS sr4,
    NULL::bigint AS sr5,
    NULL::bigint AS sr6,
    cro13av,
    endtime,
    meeting,
    remarks,
    woredas,
    deviceid,
    CAST(duration AS bigint) AS duration,
    CAST(expected AS bigint) AS expected,
    username,
    starttime,
    formdef_id,
    "instanceID",
    device_info,
    CAST(malepresent AS bigint) AS malepresent,
    school_name,
    coach_gender,
    date_coaching,
    CAST(femalepresent AS bigint) AS femalepresent,
    observer_role,
    role_coaching,
    "SubmissionDate",
    coachee_gender,
    devicephonenum,
    forms_ethiopia,
    review_quality,
    teacher_gender,
    teacher_others,
    zones_ethiopia,
    CAST(formdef_version AS bigint) AS formdef_version,
    observer_gender,
    observer_others,
    region_ethiopia,
    facilitator_role,
    meeting_coaching,
    observation_term,
    remarks_coaching,
    CAST(duration_coaching AS bigint) AS duration_coaching,
    name_of_the_coach,
    remarks_classroom,
    facilitator_gender,
    facilitator_others,
    name_of_the_coachee,
    coach_gender_specify,
    coachee_gender_specify,
    facilitator_role_coaching,
    _airbyte_raw_id,
    _airbyte_extracted_at,
    _airbyte_meta
    -- Extra fields retained as comments:
    -- program, n1, n2, n3, n4, b_secb, n_seca, n_secc, n1_secd, n1_sece, n2_sece, n3_sece, n4_sece, n5_sece,
    -- review_status, "CompletionDate", cro13av_na, cro13av_dev_cro, region (renamed as region_ethiopia)
FROM {{ source('source_classroom_surveys_new', 'ethiopia_data') }}
