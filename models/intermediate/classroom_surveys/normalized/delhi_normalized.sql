{{ config(
  materialized='table'
) }}

with cte as (
  {{ flatten_json(
      model_name = source('source_classroom_surveys_dev', 'delhi'),
      json_column = 'data'
  ) }}
)

SELECT 
    CAST(coach_gender_female AS bigint) AS coach_gender_female,
    program,
    starttime,
    "SubmissionDate",
    CAST(cro13ai_behavior_safety AS bigint) AS cro13ai_behavior_safety,
    CAST(facilitator_role_stir_dl AS bigint) AS facilitator_role_stir_dl,
    c2a,
    CAST(observer_gender_male AS bigint) AS observer_gender_male,
    remarks_coaching,
    CAST(facilitator_gender_male AS bigint) AS facilitator_gender_male,
    facilitator_others,
    CAST(cro13ai_building_a_stronger_community AS bigint) AS cro13ai_building_a_stronger_community,
    coaching_type,
    teacher_others,
    meeting,
    CAST(s1 AS bigint) AS s1,
    CAST(se1 AS bigint) AS se1,
    CAST(s2 AS bigint) AS s2,
    CAST(observer_role_brp AS bigint) AS observer_role_brp,
    CAST(s3 AS bigint) AS s3,
    CAST(se3 AS bigint) AS se3,
    CAST(s4 AS bigint) AS s4,
    CAST(se2 AS bigint) AS se2,
    CAST(facilitator_role_coaching_stir_dl AS bigint) AS facilitator_role_coaching_stir_dl,
    CAST(se5 AS bigint) AS se5,
    n5_sece,
    CAST(se4 AS bigint) AS se4,
    CAST(expected AS bigint) AS expected,
    CAST(role_coaching_elm AS bigint) AS role_coaching_elm,
    CAST(c1 AS bigint) AS c1,
    CAST(c2 AS bigint) AS c2,
    CAST(c3 AS bigint) AS c3,
    CAST(observer_gender_observer_others AS bigint) AS observer_gender_observer_others,
    caseid,
    meeting_coaching,
    "KEY",
    cro7a,
    n_seca,
    n_secc,
    CAST(cro13ai_look_for_understanding___respond AS bigint) AS cro13ai_look_for_understanding___respond,
    CAST(role_coaching_dc AS bigint) AS role_coaching_dc,
    CAST(cro13ai_classroom_routines AS bigint) AS cro13ai_classroom_routines,
    CAST(cro13ai_behavior_engagement AS bigint) AS cro13ai_behavior_engagement,
    name_of_the_coach,
    n4_sece,
    CAST(observer_role_dc AS bigint) AS observer_role_dc,
    review_quality,
    CAST(cro10 AS bigint) AS cro10,
    review_status,
    "CompletionDate",
    endtime,
    CAST(e1 AS bigint) AS e1,
    CAST(e2 AS bigint) AS e2,
    coachee_gender_specify,
    CAST(e3 AS bigint) AS e3,
    CAST("AD1" AS bigint) AS "AD1",
    CAST("AD2" AS bigint) AS "AD2",
    CAST("AD3" AS bigint) AS "AD3",
    CAST(observer_gender_female AS bigint) AS observer_gender_female,
    CAST("AD4" AS bigint) AS "AD4",
    CAST("AD5" AS bigint) AS "AD5",
    "AD6",
    CAST("AD7" AS bigint) AS "AD7",
    CAST("AD8" AS bigint) AS "AD8",
    CAST("AD9" AS bigint) AS "AD9",
    CAST(cro8 AS bigint) AS cro8,
    CAST(cro9 AS bigint) AS cro9,
    CAST(cro7 AS bigint) AS cro7,
    CAST(cro4 AS bigint) AS cro4,
    CAST(facilitator_role_brp AS bigint) AS facilitator_role_brp,
    CAST(cro5 AS bigint) AS cro5,
    CAST(cro2 AS bigint) AS cro2,
    CAST(cro3 AS bigint) AS cro3,
    CAST(duration_coaching AS bigint) AS duration_coaching,
    CAST(cro1 AS bigint) AS cro1,
    date,
    CAST(cro13ai_teaching___learning_strategies_1 AS bigint) AS cro13ai_teaching___learning_strategies_1,
    n1,
    CAST(coach_gender_male AS bigint) AS coach_gender_male,
    n2,
    n3,
    n4,
    n5,
    n6,
    n7,
    n1_sece,
    observer_others,
    CAST(cro13ai_behavior_selfesteem AS bigint) AS cro13ai_behavior_selfesteem,
    CAST(cro13ai_teaching___learning_strategies_2 AS bigint) AS cro13ai_teaching___learning_strategies_2,
    n1_secd,
    CAST(coachee_gender_male AS bigint) AS coachee_gender_male,
    CAST(observer_role_elm AS bigint) AS observer_role_elm,
    cro8a,
    CAST(facilitator_role_coaching_brp AS bigint) AS facilitator_role_coaching_brp,
    CAST(cro11 AS bigint) AS cro11,
    CAST(cro12 AS bigint) AS cro12,
    name_of_the_coachee,
    remarks_classroom,
    CAST(sr2 AS bigint) AS sr2,
    CAST(facilitator_gender_female AS bigint) AS facilitator_gender_female,
    CAST(sr1 AS bigint) AS sr1,
    "instanceID",
    devicephonenum,
    CAST(sr4 AS bigint) AS sr4,
    CAST(observer_role_diet_official AS bigint) AS observer_role_diet_official,
    CAST(sr3 AS bigint) AS sr3,
    CAST(sr6 AS bigint) AS sr6,
    CAST(sr5 AS bigint) AS sr5,
    CAST(facilitator_role_diet_official AS bigint) AS facilitator_role_diet_official,
    teacher_gender,
    remarks_additional,
    CAST(cro13ai_lesson_planning AS bigint) AS cro13ai_lesson_planning,
    n2_sece,
    CAST(observer_role_stir_dl AS bigint) AS observer_role_stir_dl,
    CAST(coachee_gender_female AS bigint) AS coachee_gender_female,
    CAST(cro13ai_mission_buniyad AS bigint) AS cro13ai_mission_buniyad,
    CAST(cro13c AS bigint) AS cro13c,
    CAST(cro13b AS bigint) AS cro13b,
    n3_sece,
    CAST(cc1 AS bigint) AS cc1,
    CAST(duration AS bigint) AS duration,
    CAST(cc3 AS bigint) AS cc3,
    CAST(cc2 AS bigint) AS cc2,
    CAST(cc5 AS bigint) AS cc5,
    CAST(femalepresent AS bigint) AS femalepresent,
    CAST(cc4 AS bigint) AS cc4,
    CAST(cro13ai_social___emotional_wellbeing AS bigint) AS cro13ai_social___emotional_wellbeing,
    CAST(facilitator_role_coaching_elm AS bigint) AS facilitator_role_coaching_elm,
    observation_term,
    CAST(cro13ai_building_connect AS bigint) AS cro13ai_building_connect,
    CAST(cro13ai_psychological_safety AS bigint) AS cro13ai_psychological_safety,
    CAST(facilitator_role_elm AS bigint) AS facilitator_role_elm,
    CAST(facilitator_role_coaching_dc AS bigint) AS facilitator_role_coaching_dc,
    date_coaching,
    CAST(facilitator_role_dc AS bigint) AS facilitator_role_dc,
    deviceid,
    CAST(formdef_version AS bigint) AS formdef_version,
    c1a,
    device_info,
    CAST(coachee_gender_others AS bigint) AS coachee_gender_others,
    CAST(facilitator_gender_facilitator_others AS bigint) AS facilitator_gender_facilitator_others,
    cro13a,
    diet_delhi,
    forms,
    remarks,
    CAST(malepresent AS bigint) AS malepresent,
    username
FROM cte
